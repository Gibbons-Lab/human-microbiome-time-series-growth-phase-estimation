---
title: "R Notebook"
output: html_notebook
---

We start by reading the metadata from our sample list.

```{r}
library(data.table)

samples <- fread("data/PRJNA544527_metadata.tsv")
samples
```

Now we read the metadata from the publication.

```{r}
library(readxl)
library(magrittr)

download.file("https://static-content.springer.com/esm/art%3A10.1038%2Fs41591-019-0559-3/MediaObjects/41591_2019_559_MOESM3_ESM.xlsx", "data/SI.xlsx")
meta <- read_excel("data/SI.xlsx", "SupTable2", skip = 3) %>% as.data.table()
meta
```

Let's combine the two:

```{r}
merged <- meta[samples, on = c(Donor = "host_subject_id")]
merged[, "time" := as.numeric(tstrsplit(`Sample Name`, "-|_")[[2]])]
merged[, "sample_id" := Run]
fwrite(merged, "data/metadata.csv")
merged
```